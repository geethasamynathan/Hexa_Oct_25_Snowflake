# **Snowflake – Database Operations**

## **1. What is a Database in Snowflake?**
- **Definition:**  
  In Snowflake, a **database** is a logical container for schemas, tables, views, and other database objects.  
- **Purpose:**
  - Organizes and stores data in an isolated namespace.
  - Allows separation of data for different projects or business units.
- **Notes:**
  - A Snowflake account can have multiple databases.
  - Each database can have multiple **schemas**, and each schema contains **tables, views, and other objects**.

---

## **2. Ways to Create a Database in Snowflake**

### **2.1. Using Web UI**
1. Login to Snowflake Web UI.
2. Navigate to **Databases** tab.
3. Click **Create** → Enter **Database Name** and optional **Comment**.
4. Click **Finish**.

---

### **2.2. Using SQL Command – Basic Syntax**
```sql
CREATE DATABASE database_name;
```

---

### **2.3. With Optional Parameters**
```sql
CREATE DATABASE sales_db
COMMENT = 'This database stores sales-related data';
```

---

### **2.4. Create Only If Not Exists**
```sql
CREATE DATABASE IF NOT EXISTS sales_db;
```
- Avoids errors if the database already exists.

---

### **2.5. Create from an Existing Database (Cloning)**
```sql
CREATE DATABASE sales_db_clone CLONE sales_db;
```
- Creates a **zero-copy clone** of the existing database.
- Useful for testing or creating point-in-time copies.

---

### **2.6. Create from a Share (Data Sharing)**
```sql
CREATE DATABASE shared_sales_db FROM SHARE provider_account.provider_share;
```
- Allows you to create a database from data shared by another Snowflake account.

---

## **3. Listing Databases**
```sql
SHOW DATABASES;
```
- Lists all databases in the current account.
```sql
SHOW DATABASES LIKE 'sales%';
```
- Lists databases matching a pattern.

---

## **4. Switching to a Database**
```sql
USE DATABASE sales_db;
```

---

## **5. Altering a Database**

### **5.1. Rename a Database**
```sql
ALTER DATABASE sales_db RENAME TO sales_database;
```

---

### **5.2. Change or Add Comment**
```sql
ALTER DATABASE sales_db SET COMMENT = 'Updated comment for sales database';
```

---

### **5.3. Suspend/Resume Database Replication**
```sql
ALTER DATABASE sales_db SUSPEND REPLICATION;
ALTER DATABASE sales_db RESUME REPLICATION;
```
(For accounts with replication enabled.)

---

### **5.4. Enable/Disable Transient Property**
```sql
ALTER DATABASE sales_db SET DATA_RETENTION_TIME_IN_DAYS = 1;
```
- Controls how long historical data is retained.

---

## **6. Dropping a Database**

### **6.1. Basic Syntax**
```sql
DROP DATABASE sales_db;
```

---

### **6.2. Drop Only If Exists**
```sql
DROP DATABASE IF EXISTS sales_db;
```

---

### **6.3. Drop All Objects Inside Database (Cascade)**
```sql
DROP DATABASE sales_db CASCADE;
```
- Removes all schemas, tables, and objects inside the database.

---

## **7. Other Database Operations**

| Operation | SQL Example | Description |
|-----------|-------------|-------------|
| **Describe Database** | `DESCRIBE DATABASE sales_db;` | Shows details like owner, created time, comment, etc. |
| **Show Grants** | `SHOW GRANTS ON DATABASE sales_db;` | Lists access privileges for the database. |
| **Grant Privileges** | `GRANT USAGE ON DATABASE sales_db TO ROLE analyst;` | Gives usage rights to a role. |
| **Revoke Privileges** | `REVOKE USAGE ON DATABASE sales_db FROM ROLE analyst;` | Removes usage rights. |
| **Clone Database** | `CREATE DATABASE clone_db CLONE sales_db;` | Creates zero-copy duplicate. |
| **Undrop Database** | `UNDROP DATABASE sales_db;` | Restores a dropped database (within retention period). |

---

✅ **Trainer Tip:**  
- Always use `IF EXISTS` and `IF NOT EXISTS` in automation scripts to avoid execution failures.  
- Use **comment fields** to document the database purpose.  
- For critical environments, enable **replication** for disaster recovery.
